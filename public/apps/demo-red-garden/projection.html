<!DOCTYPE html >  
<html lang="en">  
<head>  
  <meta charset="UTF-8">
  <title>A RED Application</title>  

  <script type="text/javascript" src="jquery-1.7.2.min.js"></script>
  <script type="text/javascript" src="jquery.thingbroker-0.3.0.min.js"></script>

  <style type="text/css">
	html * {
		background-color:black;
	}

	#water {width:500px; height:500px; position:absolute; top:0; left:0; -webkit-mask-image: url(mask2.png); background-image:url('water.gif');
	}
	#mask {background-color:black; width:500px; height:420px; position:absolute; top:0; left:0; z-index: 10;
	}
     

  </style>

</head>  

<body>


<div id="water"></div>
<div id="mask"></div>

<div id="demowatergarden1396992920">
<div id="demothankyou1396992920">
<div id="demovirtualwater1396992920"></div>

<script type="text/javascript">
  	$("#water").click(function(){deplete()});

	function deplete() {		
		$("#mask").animate({height:'440'},4000)
   		var t = $.ThingBroker({debug:true,url:"http://192.168.2.111:8080/thingbroker",container:false});
		t.postThing({thingId: "demowatergarden1396992920"});
		var e = t.postEvent("#demowatergarden1396992920", {'type':'digital','13':'1','timeout':'20'});
		t.postThing({thingId: "demothankyou1396992920"});
		var e = t.postEvent("#demothankyou1396992920", {});

	}
	function replenish() {
		if ($("#mask").height() > 100){
  		        $("#mask").animate({height: $('#mask').height() - 50 },1000);
		}
	}

	$("#demovirtualwater1396992920").thing({listen:true,
		   url:"http://192.168.2.111:8080/thingbroker",
                   debug:true,
		   container:false,
                   eventCallback:function(json){
                                                replenish();
                                               }
        });

</script>

</body>
</html>
